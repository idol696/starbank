# Требования по развертыванию проекта

## Операционная система

Проект должен быть совместим с операционными системами:
* Windows

* macOS

* Linux

## Установленные компоненты

• Java Development Kit (JDK): Необходима версия JDK 11 или выше.

• Среда выполнения Java (JRE): Должна быть установлена для запуска приложения.

• Система управления версиями (опционально): Git для управления исходным кодом.

## База данных


Сервер баз данных:

  • PostgreSQL (версии 12 и выше)

  • Установите PostgreSQL и настройте базу данных для хранения динамических правил.

  
Встраиваемая база данных:

  • H2 (входит в зависимости проекта, не требует отдельной установки)


Настройка базы данных:

  • База данных должна быть предварительно заполнена данными о пользователях, продуктах и операциях.

  • Настройте файл конфигурации application.properties для подключения к базе данных H2.



## Зависимости

Добавьте в файл pom.xml следующие зависимости:
  
```  
		<!-- Spring Boot Starter Data Web -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

		<!-- H2 database -->
		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
			<version>2.2.224</version>
		</dependency>

		<!-- Spring Data JPA -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>

		<!-- Spring Data JDBC-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jdbc</artifactId>
		</dependency>

		<!-- PostgreSQL JDBC Driver -->
		<dependency>
			<groupId>org.postgresql</groupId>
			<artifactId>postgresql</artifactId>
		</dependency>

		<!-- Springdoc OpenAPI UI -->
		<dependency>
			<groupId>org.springdoc</groupId>
			<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
			<version>2.7.0</version>
		</dependency>

		<!-- Spring Boot Test -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>

		<!-- Hibernate Validator -->
		<dependency>
			<groupId>org.hibernate.validator</groupId>
			<artifactId>hibernate-validator</artifactId>
			<version>8.0.1.Final</version>
		</dependency>

		<!-- Liquibase Core-->
		<dependency>
			<groupId>org.liquibase</groupId>
			<artifactId>liquibase-core</artifactId>
		</dependency>

		<!-- Cache Caffeine -->
		<dependency>
			<groupId>com.github.ben-manes.caffeine</groupId>
			<artifactId>caffeine</artifactId>
			<version>3.1.8</version>
		</dependency>

		<!-- Spring Cache Extension -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-cache</artifactId>
		</dependency>

		<!-- Telegram Bots Library -->
		<dependency>
			<groupId>org.telegram</groupId>
			<artifactId>telegrambots</artifactId>
			<version>6.9.7.1</version>
		</dependency>

		<!-- Jakarta Annotation for JSON -->
		<dependency>
			<groupId>jakarta.annotation</groupId>
			<artifactId>jakarta.annotation-api</artifactId>
			<version>2.1.1</version>
		</dependency>

	</dependencies>


	<!-- Hibernate Validator -->
		<dependency>
			<groupId>org.hibernate.validator</groupId>
			<artifactId>hibernate-validator</artifactId>
			<version>8.0.1.Final</version>
		</dependency>


	<!-- Liquibase Core-->
		<dependency>
			<groupId>org.liquibase</groupId>
			<artifactId>liquibase-core</artifactId>
		</dependency>
  
```

## Конфигурация подключения к базе данных

Создайте файл application.properties в директории src/main/resources со следующим содержимым:

```
  spring.application.name=starbank

# H2
application.recommendations-db.url=jdbc:h2:file:./transaction;DB_CLOSE_DELAY=-1;ACCESS_MODE_DATA=r

#  PostgreSQL
spring.datasource.url=jdbc:postgresql://localhost:5432/starbank
spring.datasource.username=${postgres-login}
spring.datasource.password=${postgres-passwd}
spring.datasource.driver-class-name=org.postgresql.Driver

#  Hibernate
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.order_inserts=true

# Liquibase
spring.liquibase.enabled=true
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.xml

# Caffeline Cache
spring.cache.type=caffeine

# DEBUG
logging.level.com.skypro.starbank=DEBUG
#logging.level.liquibase=DEBUG

# Telegram Bot
telegram.bot.username=${telegram-botname}
telegram.bot.token=${telegram-token}
  
```

## Запуск проекта

Для запуска проекта выполните следующие шаги:

  • Перейдите в корневую директорию проекта.

  • Скомпилируйте проект с помощью Maven (mvn clean install)

  • Запустите приложение: java -jar -Dpostgres-login=логин -Dpostgres-passwd=пароль -Dtelegram-botname=имя бота телеграмм -Dtelegram-token=токен бота телеграм starbank.jar

  • После этого система станет доступна (локально: https://localhost:8080)

## Тестирование

• После запуска приложения проверьте его работоспособность, введя ID пользователя в консольном приложении и убедившись, что сервис возвращает рекомендации по продуктам. End-point /recommendation/{user-UUID}  (можете использовать тестовые данные https://localhost:8080/recommendation/f37ba8a8-3cd5-4976-9f74-2b21f105da67) 

• Доступно удаление, добавление правил по следующим End-points: 
  > удаление  DELETE /rule/<Long id> - ID правила
  > получение всех правил GET /rule
  > добавление правила POST /rule

• Доступен swagger /swagger-ui/index.html

• Доступна информация о версии проекта /management/info

• Доступна очистка кэша  /management/clear-cache


## Заключение

Следуя этим требованиям, вы сможете успешно развернуть проект рекомендательной системы банка «Стар». В дальнейшем возможны доработки и улучшения на основе обратной связи от пользователей и сотрудников банка.