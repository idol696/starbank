# Требования по развертыванию проекта

## Операционная система

Проект должен быть совместим с операционными системами:
* Windows

* macOS

* Linux

## Установленные компоненты

• Java Development Kit (JDK): Необходима версия JDK 11 или выше.

• Среда выполнения Java (JRE): Должна быть установлена для запуска приложения.

• Система управления версиями (опционально): Git для управления исходным кодом.

## База данных


Сервер баз данных:

  • PostgreSQL (версии 12 и выше)

  • Установите PostgreSQL и настройте базу данных для хранения динамических правил.

  
Встраиваемая база данных:

  • H2 (входит в зависимости проекта, не требует отдельной установки)


Настройка базы данных:

  • База данных должна быть предварительно заполнена данными о пользователях, продуктах и операциях.

  • Настройте файл конфигурации application.properties для подключения к базе данных H2.

## Структура проекта

Создайте структуру проекта, которая должна включать следующие директории и файлы:

  ```  
  StarBank
  ├── src
  │   ├── main
  │   │   ├── java/com/skypro/starbank
  │   │   │   └──configuration
  │   │   │       └──DataSourceConfiguration 
  │   │   │       └──SwaggerConfig    
  │   │   │   ├──controller 
  │   │   │       └──RecommendationController      
  │   │   │       └──GlobalExceptionHandler       
  │   │   │   ├──exception             
  │   │   │       └──RecommendationNotFoundException
  │   │   │       └──RulesNotFoundException
  │   │   │   ├──model 
  │   │   │       └──rules
  │   │   │           └──Rule
  │   │   │           └──RuleSet
  │   │   │           └──RuleSetWrapper
  │   │   │       └──Product
  │   │   │       └──Recommendation
  │   │   │       └──RecommendationResponse 
  │   │   │       └──Transaction
  │   │   │       └──User   
  │   │   │   ├──repository   
  │   │   │       └──ProductRepository
  │   │   │       └──TransactionRepository
  │   │   │       └──UserRepository
  │   │   │   ├──service  
  │   │   │       └──RecommendationService                 
  │   │   │       └──RecommendationServiceImpl
  │   │   │       └──RuleService          
  │   │   │       └──RuleServiceImpl
  │   │   │   ├──StarBankApplication     
  │   │   └── resources
  │   │       └── application.properties
  └── pom.xml 
  
```
## Зависимости

Добавьте в файл pom.xml следующие зависимости:
  
```  
      <!-- Spring Boot Starter Data Web -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

	<!-- H2 database -->
		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
			<version>2.2.224</version>
		</dependency>

	<!-- Spring Data JPA -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>

		<!-- Spring Data JDBC-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jdbc</artifactId>
		</dependency>

	<!-- PostgreSQL JDBC Driver -->
		<dependency>
			<groupId>org.postgresql</groupId>
			<artifactId>postgresql</artifactId>
		</dependency>

	<!-- Mockito -->
		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-core</artifactId>
			<version>5.12.0</version>
			<scope>test</scope>
		</dependency>

	<!-- Springdoc OpenAPI UI -->
		<dependency>
			<groupId>org.springdoc</groupId>
			<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
			<version>2.7.0</version>
		</dependency>

	<!-- Spring Boot Test -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>

	<!-- Hibernate Validator -->
		<dependency>
			<groupId>org.hibernate.validator</groupId>
			<artifactId>hibernate-validator</artifactId>
			<version>8.0.1.Final</version>
		</dependency>

	<!-- AssertJ -->
		<dependency>
			<groupId>org.assertj</groupId>
			<artifactId>assertj-core</artifactId>
			<version>3.24.2</version>
			<scope>test</scope>
		</dependency>

	<!-- Liquibase Core-->
		<dependency>
			<groupId>org.liquibase</groupId>
			<artifactId>liquibase-core</artifactId>
		</dependency>
  
```

## Конфигурация подключения к базе данных

Создайте файл application.properties в директории src/main/resources со следующим содержимым:

```
  spring.application.name=starbank

# H2
application.recommendations-db.url=jdbc:h2:file:./transaction;DB_CLOSE_DELAY=-1;ACCESS_MODE_DATA=r

#  PostgreSQL
spring.datasource.url=jdbc:postgresql://localhost:5432/starbank
spring.datasource.username=${postgres-login}
spring.datasource.password=${postgres-passwd}
spring.datasource.driver-class-name=org.postgresql.Driver

#  Hibernate
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.order_inserts=true

# Liquibase
spring.liquibase.enabled=true
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.xml

# DEBUG
logging.level.com.skypro.starbank=DEBUG
#logging.level.liquibase=DEBUG
  
```

## Запуск проекта

Для запуска проекта выполните следующие шаги:

  • Перейдите в корневую директорию проекта.

  • Скомпилируйте проект с помощью Maven (mvn clean install)

  • Запустите приложение: mvn exec:java -Dexec.mainClass="com.bank.Main"

## Тестирование

• После запуска приложения проверьте его работоспособность, введя ID пользователя в консольном приложении и убедившись, что сервис возвращает рекомендации по продуктам.

## Заключение

Следуя этим требованиям, вы сможете успешно развернуть проект рекомендательной системы банка «Стар». В дальнейшем возможны доработки и улучшения на основе обратной связи от пользователей и сотрудников банка.